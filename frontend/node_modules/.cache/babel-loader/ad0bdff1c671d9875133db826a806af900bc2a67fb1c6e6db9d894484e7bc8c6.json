{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{AuthContext}from'../context/AuthContext';import axiosInstance from'../api/axiosConfig';import CameraCapture from'../components/CameraCapture';import Clock from'../components/Clock';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AttendanceCheck=()=>{const{user}=useContext(AuthContext);const[lastAttendance,setLastAttendance]=useState(null);const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');const logoUrl='https://upload.wikimedia.org/wikipedia/commons/7/72/Checkbox_icon.svg';useEffect(()=>{fetchLastAttendance();},[]);const fetchLastAttendance=async()=>{try{const res=await axiosInstance.get('/attendance/myattendances');setLastAttendance(res.data[0]||null);}catch(error){console.error(error);}};const handleCheckIn=async photo=>{setLoading(true);setMessage('');try{const res=await axiosInstance.post('/attendance/checkin',{photo});setMessage('Check-in recorded successfully');setLastAttendance(res.data.attendance);}catch(error){var _error$response,_error$response$data;setMessage(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Check-in failed');}finally{setLoading(false);}};const handleCheckOut=async photo=>{if(!(lastAttendance!==null&&lastAttendance!==void 0&&lastAttendance._id)){setMessage('Please check-in first');return;}if(lastAttendance.checkOutTime){setMessage('Already checked out');return;}setLoading(true);setMessage('');try{const res=await axiosInstance.post(`/attendance/checkout/${lastAttendance._id}`,{photo});setMessage('Check-out recorded successfully');setLastAttendance(res.data.attendance);}catch(error){var _error$response2,_error$response2$data;setMessage(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Check-out failed');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:600,margin:'40px auto',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"img\",{src:logoUrl,alt:\"Logo\",style:{width:80}}),/*#__PURE__*/_jsx(\"h1\",{children:\"Employee Check-in/Check-out System\"}),/*#__PURE__*/_jsx(Clock,{}),/*#__PURE__*/_jsx(CameraCapture,{onCapture:imgData=>{if(!lastAttendance||lastAttendance.checkOutTime){handleCheckIn(imgData);}else{handleCheckOut(imgData);}}}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Processing...\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),lastAttendance&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:20,textAlign:'left',border:'1px solid #ccc',padding:10},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Last Attendance Record\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Check-in Time:\"}),\" \",new Date(lastAttendance.checkInTime).toLocaleString()]}),/*#__PURE__*/_jsx(\"img\",{src:lastAttendance.checkInPhoto,alt:\"Check In\",style:{width:100,borderRadius:10}}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Check-out Time:\"}),\" \",lastAttendance.checkOutTime?new Date(lastAttendance.checkOutTime).toLocaleString():'Not checked out yet']}),lastAttendance.checkOutPhoto&&/*#__PURE__*/_jsx(\"img\",{src:lastAttendance.checkOutPhoto,alt:\"Check Out\",style:{width:100,borderRadius:10}})]})]});};export default AttendanceCheck;","map":{"version":3,"names":["React","useContext","useEffect","useState","AuthContext","axiosInstance","CameraCapture","Clock","jsx","_jsx","jsxs","_jsxs","AttendanceCheck","user","lastAttendance","setLastAttendance","loading","setLoading","message","setMessage","logoUrl","fetchLastAttendance","res","get","data","error","console","handleCheckIn","photo","post","attendance","_error$response","_error$response$data","response","handleCheckOut","_id","checkOutTime","_error$response2","_error$response2$data","style","maxWidth","margin","textAlign","children","src","alt","width","onCapture","imgData","marginTop","border","padding","Date","checkInTime","toLocaleString","checkInPhoto","borderRadius","checkOutPhoto"],"sources":["D:/tcs/frontend/src/pages/AttendanceCheck.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport axiosInstance from '../api/axiosConfig';\r\nimport CameraCapture from '../components/CameraCapture';\r\nimport Clock from '../components/Clock';\r\n\r\nconst AttendanceCheck = () => {\r\n  const { user } = useContext(AuthContext);\r\n  const [lastAttendance, setLastAttendance] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n\r\n  const logoUrl = 'https://upload.wikimedia.org/wikipedia/commons/7/72/Checkbox_icon.svg';\r\n\r\n  useEffect(() => {\r\n    fetchLastAttendance();\r\n  }, []);\r\n\r\n  const fetchLastAttendance = async () => {\r\n    try {\r\n      const res = await axiosInstance.get('/attendance/myattendances');\r\n      setLastAttendance(res.data[0] || null);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const handleCheckIn = async (photo) => {\r\n    setLoading(true);\r\n    setMessage('');\r\n    try {\r\n      const res = await axiosInstance.post('/attendance/checkin', { photo });\r\n      setMessage('Check-in recorded successfully');\r\n      setLastAttendance(res.data.attendance);\r\n    } catch (error) {\r\n      setMessage(error.response?.data?.message || 'Check-in failed');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCheckOut = async (photo) => {\r\n    if (!lastAttendance?._id) {\r\n      setMessage('Please check-in first');\r\n      return;\r\n    }\r\n    if (lastAttendance.checkOutTime) {\r\n      setMessage('Already checked out');\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    setMessage('');\r\n    try {\r\n      const res = await axiosInstance.post(`/attendance/checkout/${lastAttendance._id}`, { photo });\r\n      setMessage('Check-out recorded successfully');\r\n      setLastAttendance(res.data.attendance);\r\n    } catch (error) {\r\n      setMessage(error.response?.data?.message || 'Check-out failed');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ maxWidth: 600, margin: '40px auto', textAlign: 'center' }}>\r\n      <img src={logoUrl} alt=\"Logo\" style={{ width: 80 }} />\r\n      <h1>Employee Check-in/Check-out System</h1>\r\n      <Clock />\r\n      <CameraCapture\r\n        onCapture={(imgData) => {\r\n          if (!lastAttendance || lastAttendance.checkOutTime) {\r\n            handleCheckIn(imgData);\r\n          } else {\r\n            handleCheckOut(imgData);\r\n          }\r\n        }}\r\n      />\r\n      {loading && <p>Processing...</p>}\r\n      {message && <p>{message}</p>}\r\n      {lastAttendance && (\r\n        <div style={{ marginTop: 20, textAlign: 'left', border: '1px solid #ccc', padding: 10 }}>\r\n          <h3>Last Attendance Record</h3>\r\n          <p><strong>Check-in Time:</strong> {new Date(lastAttendance.checkInTime).toLocaleString()}</p>\r\n          <img src={lastAttendance.checkInPhoto} alt=\"Check In\" style={{ width: 100, borderRadius: 10 }} />\r\n          <p><strong>Check-out Time:</strong> {lastAttendance.checkOutTime ? new Date(lastAttendance.checkOutTime).toLocaleString() : 'Not checked out yet'}</p>\r\n          {lastAttendance.checkOutPhoto && <img src={lastAttendance.checkOutPhoto} alt=\"Check Out\" style={{ width: 100, borderRadius: 10 }} />}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AttendanceCheck;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}